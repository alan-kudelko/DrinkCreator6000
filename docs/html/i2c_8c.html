<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DrinkCreator6000: avr_peripherals/i2c/i2c.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">DrinkCreator6000
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('i2c_8c.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">i2c.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="i2c_8h_source.html">i2c.h</a>&gt;</code><br />
<code>#include &lt;avr/io.h&gt;</code><br />
<code>#include &lt;avr/interrupt.h&gt;</code><br />
<code>#include &lt;<a class="el" href="_drink_creator6000___pins_8h_source.html">DrinkCreator6000_Pins.h</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for i2c.c:</div>
<div class="dyncontent">
<div class="center"><img src="i2c_8c__incl.png" border="0" usemap="#aavr__peripherals_2i2c_2i2c_8c" loading="lazy" alt=""/></div>
<map name="aavr__peripherals_2i2c_2i2c_8c" id="aavr__peripherals_2i2c_2i2c_8c">
<area shape="rect" title=" " alt="" coords="153,5,284,48"/>
<area shape="rect" href="i2c_8h.html" title="I2C (TWI) Master driver for AVR (ATmega2560)." alt="" coords="59,96,109,123"/>
<area shape="poly" title=" " alt="" coords="185,51,119,90,117,85,183,46"/>
<area shape="rect" title=" " alt="" coords="133,96,197,123"/>
<area shape="poly" title=" " alt="" coords="207,50,184,84,180,81,203,47"/>
<area shape="rect" title=" " alt="" coords="221,96,323,123"/>
<area shape="poly" title=" " alt="" coords="235,47,257,81,253,84,230,50"/>
<area shape="rect" href="_drink_creator6000___pins_8h.html" title="IO Mapping: Pin definitions and button mappings." alt="" coords="347,96,514,123"/>
<area shape="poly" title=" " alt="" coords="274,46,384,88,382,93,272,51"/>
<area shape="rect" title=" " alt="" coords="225,320,289,347"/>
<area shape="poly" title=" " alt="" coords="73,125,47,153,22,192,13,212,9,233,10,252,19,270,31,280,49,290,99,305,210,324,209,330,98,310,47,295,28,285,15,274,5,254,3,232,8,211,17,189,43,150,69,121"/>
<area shape="rect" title=" " alt="" coords="47,171,121,197"/>
<area shape="poly" title=" " alt="" coords="87,123,87,155,81,155,81,123"/>
<area shape="rect" href="_drink_creator6000___config___c_8h.html" title="Centralized configuration header for the DrinkCreator6000 system." alt="" coords="155,171,351,197"/>
<area shape="poly" title=" " alt="" coords="110,119,211,162,209,167,108,124"/>
<area shape="rect" title=" " alt="" coords="29,245,123,272"/>
<area shape="poly" title=" " alt="" coords="223,200,122,242,120,237,221,195"/>
<area shape="rect" title=" " alt="" coords="147,245,205,272"/>
<area shape="poly" title=" " alt="" coords="242,200,202,237,199,233,238,196"/>
<area shape="rect" title=" " alt="" coords="229,245,296,272"/>
<area shape="poly" title=" " alt="" coords="258,198,262,230,256,230,252,198"/>
<area shape="rect" title=" " alt="" coords="321,245,396,272"/>
<area shape="poly" title=" " alt="" coords="273,196,329,234,326,238,270,200"/>
<area shape="rect" href="_drink_creator6000___data_types_8h.html" title=" " alt="" coords="420,245,625,272"/>
<area shape="poly" title=" " alt="" coords="301,195,462,238,460,243,300,200"/>
<area shape="poly" title=" " alt="" coords="477,275,306,322,304,317,476,270"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5730d9445429351b9f750084c5cb5aae" id="r_a5730d9445429351b9f750084c5cb5aae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5730d9445429351b9f750084c5cb5aae">i2c_init</a> (void)</td></tr>
<tr class="memdesc:a5730d9445429351b9f750084c5cb5aae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize I²C (TWI) hardware and optional Timer4 support.  <br /></td></tr>
<tr class="memitem:a5a1923e2271df541e858cb4e05d7b895" id="r_a5a1923e2271df541e858cb4e05d7b895"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5a1923e2271df541e858cb4e05d7b895">i2c_enable</a> (void)</td></tr>
<tr class="memdesc:a5a1923e2271df541e858cb4e05d7b895"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable I²C hardware (and Timer4 if used).  <br /></td></tr>
<tr class="memitem:abe70f8fe4c72329b89ec526c749f50d7" id="r_abe70f8fe4c72329b89ec526c749f50d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abe70f8fe4c72329b89ec526c749f50d7">i2c_disable</a> (void)</td></tr>
<tr class="memdesc:abe70f8fe4c72329b89ec526c749f50d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable I²C hardware (and Timer4 if used).  <br /></td></tr>
<tr class="memitem:a34466b1132aef1e13135a1a7bcf65ac0" id="r_a34466b1132aef1e13135a1a7bcf65ac0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a34466b1132aef1e13135a1a7bcf65ac0">i2c_tx_buffer_clear_until_next_address</a> (void)</td></tr>
<tr class="memdesc:a34466b1132aef1e13135a1a7bcf65ac0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clears the TX buffer until the next address package is found.  <br /></td></tr>
<tr class="memitem:a8aa6a32130ab26be17555166513a23ba" id="r_a8aa6a32130ab26be17555166513a23ba"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8aa6a32130ab26be17555166513a23ba">ISR</a> (TIMER4_COMPA_vect)</td></tr>
<tr class="memitem:a474f42eedbdc093683fdb4b88be3c48f" id="r_a474f42eedbdc093683fdb4b88be3c48f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a474f42eedbdc093683fdb4b88be3c48f">ISR</a> (TWI_vect)</td></tr>
<tr class="memitem:a91bb1859c12fbc7c029b2a5a2309b240" id="r_a91bb1859c12fbc7c029b2a5a2309b240"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a91bb1859c12fbc7c029b2a5a2309b240">i2c_write_byte_to_address_blocking</a> (uint8_t address, uint8_t data)</td></tr>
<tr class="memdesc:a91bb1859c12fbc7c029b2a5a2309b240"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a single data byte to the specified I2C slave address in blocking mode.  <br /></td></tr>
<tr class="memitem:ae74a6ec74823b5c3816959f3f696e945" id="r_ae74a6ec74823b5c3816959f3f696e945"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae74a6ec74823b5c3816959f3f696e945">i2c_write_bytes_to_address_blocking</a> (uint8_t address, uint8_t *data, uint8_t length)</td></tr>
<tr class="memdesc:ae74a6ec74823b5c3816959f3f696e945"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends multiple data bytes to the specified I2C slave address in blocking mode.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:abe1f812dc6284ef881acc78023cd7a9d" id="r_abe1f812dc6284ef881acc78023cd7a9d"><td class="memItemLeft" align="right" valign="top">volatile <a class="el" href="struct_i2_c___data__t.html">I2C_Data_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abe1f812dc6284ef881acc78023cd7a9d">i2c_buffer_tx</a> [<a class="el" href="i2c_8h.html#a547981ee4a0a60f7fa4826eb59ded9b7">I2C_TX_BUFFER_SIZE</a>] ={0}</td></tr>
<tr class="memdesc:abe1f812dc6284ef881acc78023cd7a9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transmit buffer holding I2C data packets to be sent.  <br /></td></tr>
<tr class="memitem:a5b113d44bda8ed39efc026d277878c09" id="r_a5b113d44bda8ed39efc026d277878c09"><td class="memItemLeft" align="right" valign="top">volatile <a class="el" href="i2c_8h.html#a57b79314a222c848e2e86e83758e667e">i2c_tx_buf_index_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5b113d44bda8ed39efc026d277878c09">i2c_tx_buffer_head</a> =0</td></tr>
<tr class="memdesc:a5b113d44bda8ed39efc026d277878c09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index of the head position in the TX buffer.  <br /></td></tr>
<tr class="memitem:aab3b5c0fa4c5e46e6d6009f357dc891e" id="r_aab3b5c0fa4c5e46e6d6009f357dc891e"><td class="memItemLeft" align="right" valign="top">volatile <a class="el" href="i2c_8h.html#a57b79314a222c848e2e86e83758e667e">i2c_tx_buf_index_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aab3b5c0fa4c5e46e6d6009f357dc891e">i2c_tx_buffer_tail</a> =0</td></tr>
<tr class="memdesc:aab3b5c0fa4c5e46e6d6009f357dc891e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index of the tail position in the TX buffer.  <br /></td></tr>
<tr class="memitem:aec1f537d4e465641ecde4ad6ec87b894" id="r_aec1f537d4e465641ecde4ad6ec87b894"><td class="memItemLeft" align="right" valign="top">volatile uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aec1f537d4e465641ecde4ad6ec87b894">i2c_status</a> =0</td></tr>
<tr class="memdesc:aec1f537d4e465641ecde4ad6ec87b894"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current status of the I2C state machine.  <br /></td></tr>
<tr class="memitem:a41fd49c4a663a655243908d0f709bd1a" id="r_a41fd49c4a663a655243908d0f709bd1a"><td class="memItemLeft" align="right" valign="top">volatile uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a41fd49c4a663a655243908d0f709bd1a">i2c_state</a> =<a class="el" href="i2c_8h.html#ae3f6a60c396d9f1a51eb4ecc981951fa">I2C_STATE_IDLE</a></td></tr>
<tr class="memdesc:a41fd49c4a663a655243908d0f709bd1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current state of the I²C finite state machine (FSM).  <br /></td></tr>
<tr class="memitem:af0c4e2f4e0af62fc7bc45e616dd761d5" id="r_af0c4e2f4e0af62fc7bc45e616dd761d5"><td class="memItemLeft" align="right" valign="top">volatile <a class="el" href="struct_i2_c___error_counters__t.html">I2C_ErrorCounters_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af0c4e2f4e0af62fc7bc45e616dd761d5">i2c_error_counters</a> ={0}</td></tr>
<tr class="memdesc:af0c4e2f4e0af62fc7bc45e616dd761d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">I²C error counters.  <br /></td></tr>
</table>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="abe70f8fe4c72329b89ec526c749f50d7" name="abe70f8fe4c72329b89ec526c749f50d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe70f8fe4c72329b89ec526c749f50d7">&#9670;&#160;</a></span>i2c_disable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void i2c_disable </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Disable I²C hardware (and Timer4 if used). </p>

</div>
</div>
<a id="a5a1923e2271df541e858cb4e05d7b895" name="a5a1923e2271df541e858cb4e05d7b895"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a1923e2271df541e858cb4e05d7b895">&#9670;&#160;</a></span>i2c_enable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void i2c_enable </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enable I²C hardware (and Timer4 if used). </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="i2c_8c_a5a1923e2271df541e858cb4e05d7b895_icgraph.png" border="0" usemap="#ai2c_8c_a5a1923e2271df541e858cb4e05d7b895_icgraph" loading="lazy" alt=""/></div>
<map name="ai2c_8c_a5a1923e2271df541e858cb4e05d7b895_icgraph" id="ai2c_8c_a5a1923e2271df541e858cb4e05d7b895_icgraph">
<area shape="rect" title="Enable I²C hardware (and Timer4 if used)." alt="" coords="271,5,354,32"/>
<area shape="rect" href="_drink_creator6000___init_8cpp.html#aaaca845b980f160a23d3b990338d4602" title="Initialize RTOS memory resources and guard zones." alt="" coords="99,5,223,32"/>
<area shape="poly" title=" " alt="" coords="255,21,224,21,224,16,255,16"/>
<area shape="rect" href="_drink_creator6000___init_8cpp.html#ac13b6984fbac2d70b163e388a2d06155" title=" " alt="" coords="5,5,51,32"/>
<area shape="poly" title=" " alt="" coords="83,21,51,21,51,16,83,16"/>
</map>
</div>

</div>
</div>
<a id="a5730d9445429351b9f750084c5cb5aae" name="a5730d9445429351b9f750084c5cb5aae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5730d9445429351b9f750084c5cb5aae">&#9670;&#160;</a></span>i2c_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void i2c_init </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize I²C (TWI) hardware and optional Timer4 support. </p>
<p>Configures SDA/SCL pins, sets TWI speed, and optionally sets up Timer4 for polling cycles after STOP condition (used in blocking ring buffer mode). </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="i2c_8c_a5730d9445429351b9f750084c5cb5aae_icgraph.png" border="0" usemap="#ai2c_8c_a5730d9445429351b9f750084c5cb5aae_icgraph" loading="lazy" alt=""/></div>
<map name="ai2c_8c_a5730d9445429351b9f750084c5cb5aae_icgraph" id="ai2c_8c_a5730d9445429351b9f750084c5cb5aae_icgraph">
<area shape="rect" title="Initialize I²C (TWI) hardware and optional Timer4 support." alt="" coords="271,5,333,32"/>
<area shape="rect" href="_drink_creator6000___init_8cpp.html#aaaca845b980f160a23d3b990338d4602" title="Initialize RTOS memory resources and guard zones." alt="" coords="99,5,223,32"/>
<area shape="poly" title=" " alt="" coords="255,21,223,21,223,16,255,16"/>
<area shape="rect" href="_drink_creator6000___init_8cpp.html#ac13b6984fbac2d70b163e388a2d06155" title=" " alt="" coords="5,5,51,32"/>
<area shape="poly" title=" " alt="" coords="83,21,51,21,51,16,83,16"/>
</map>
</div>

</div>
</div>
<a id="a34466b1132aef1e13135a1a7bcf65ac0" name="a34466b1132aef1e13135a1a7bcf65ac0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34466b1132aef1e13135a1a7bcf65ac0">&#9670;&#160;</a></span>i2c_tx_buffer_clear_until_next_address()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void i2c_tx_buffer_clear_until_next_address </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clears the TX buffer until the next address package is found. </p>
<p>This function advances the TX buffer tail index, effectively removing data packets until it reaches the next address package or the buffer head. It is used to discard pending data if a slave failed to respond, allowing the next transmission to be properly enqueued. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="i2c_8c_a34466b1132aef1e13135a1a7bcf65ac0_icgraph.png" border="0" usemap="#ai2c_8c_a34466b1132aef1e13135a1a7bcf65ac0_icgraph" loading="lazy" alt=""/></div>
<map name="ai2c_8c_a34466b1132aef1e13135a1a7bcf65ac0_icgraph" id="ai2c_8c_a34466b1132aef1e13135a1a7bcf65ac0_icgraph">
<area shape="rect" title="Clears the TX buffer until the next address package is found." alt="" coords="98,5,235,48"/>
<area shape="rect" href="i2c_8c.html#a474f42eedbdc093683fdb4b88be3c48f" title=" " alt="" coords="5,13,50,40"/>
<area shape="poly" title=" " alt="" coords="82,29,50,29,50,24,82,24"/>
</map>
</div>

</div>
</div>
<a id="a91bb1859c12fbc7c029b2a5a2309b240" name="a91bb1859c12fbc7c029b2a5a2309b240"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91bb1859c12fbc7c029b2a5a2309b240">&#9670;&#160;</a></span>i2c_write_byte_to_address_blocking()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void i2c_write_byte_to_address_blocking </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>address</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>data</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends a single data byte to the specified I2C slave address in blocking mode. </p>
<p>This function enqueues the address and data byte into the TX buffer and waits until there is enough space in the buffer before returning. Interrupts are temporarily disabled during buffer updates to ensure atomicity and data consistency.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">address</td><td>7-bit I2C slave address. </td></tr>
    <tr><td class="paramname">data</td><td>Single byte to be transmitted. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae74a6ec74823b5c3816959f3f696e945" name="ae74a6ec74823b5c3816959f3f696e945"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae74a6ec74823b5c3816959f3f696e945">&#9670;&#160;</a></span>i2c_write_bytes_to_address_blocking()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void i2c_write_bytes_to_address_blocking </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>address</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>length</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends multiple data bytes to the specified I2C slave address in blocking mode. </p>
<p>This function enqueues the address and data bytes into the TX buffer and waits until there is enough space in the buffer before returning. Interrupts are temporarily disabled during buffer updates to ensure atomicity and data consistency.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">address</td><td>7-bit I2C slave address. </td></tr>
    <tr><td class="paramname">data</td><td>Pointer to the data array to be transmitted. </td></tr>
    <tr><td class="paramname">length</td><td>Number of bytes to send. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8aa6a32130ab26be17555166513a23ba" name="a8aa6a32130ab26be17555166513a23ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8aa6a32130ab26be17555166513a23ba">&#9670;&#160;</a></span>ISR() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ISR </td>
          <td>(</td>
          <td class="paramtype">TIMER4_COMPA_vect</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="i2c_8c_a8aa6a32130ab26be17555166513a23ba_cgraph.png" border="0" usemap="#ai2c_8c_a8aa6a32130ab26be17555166513a23ba_cgraph" loading="lazy" alt=""/></div>
<map name="ai2c_8c_a8aa6a32130ab26be17555166513a23ba_cgraph" id="ai2c_8c_a8aa6a32130ab26be17555166513a23ba_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,50,32"/>
<area shape="rect" href="i2c_8h.html#a5d09f10466d174ce0b5c5bb3045eb52f" title="Checks if the I2C TX buffer is empty." alt="" coords="98,5,253,32"/>
<area shape="poly" title=" " alt="" coords="50,16,82,16,82,21,50,21"/>
</map>
</div>

</div>
</div>
<a id="a474f42eedbdc093683fdb4b88be3c48f" name="a474f42eedbdc093683fdb4b88be3c48f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a474f42eedbdc093683fdb4b88be3c48f">&#9670;&#160;</a></span>ISR() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ISR </td>
          <td>(</td>
          <td class="paramtype">TWI_vect</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="i2c_8c_a474f42eedbdc093683fdb4b88be3c48f_cgraph.png" border="0" usemap="#ai2c_8c_a474f42eedbdc093683fdb4b88be3c48f_cgraph" loading="lazy" alt=""/></div>
<map name="ai2c_8c_a474f42eedbdc093683fdb4b88be3c48f_cgraph" id="ai2c_8c_a474f42eedbdc093683fdb4b88be3c48f_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,50,40"/>
<area shape="rect" href="i2c_8c.html#a34466b1132aef1e13135a1a7bcf65ac0" title="Clears the TX buffer until the next address package is found." alt="" coords="98,5,235,48"/>
<area shape="poly" title=" " alt="" coords="50,24,82,24,82,29,50,29"/>
</map>
</div>

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Variable Documentation</h2>
<a id="abe1f812dc6284ef881acc78023cd7a9d" name="abe1f812dc6284ef881acc78023cd7a9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe1f812dc6284ef881acc78023cd7a9d">&#9670;&#160;</a></span>i2c_buffer_tx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile <a class="el" href="struct_i2_c___data__t.html">I2C_Data_t</a> i2c_buffer_tx[<a class="el" href="i2c_8h.html#a547981ee4a0a60f7fa4826eb59ded9b7">I2C_TX_BUFFER_SIZE</a>] ={0}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transmit buffer holding I2C data packets to be sent. </p>

</div>
</div>
<a id="af0c4e2f4e0af62fc7bc45e616dd761d5" name="af0c4e2f4e0af62fc7bc45e616dd761d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0c4e2f4e0af62fc7bc45e616dd761d5">&#9670;&#160;</a></span>i2c_error_counters</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile <a class="el" href="struct_i2_c___error_counters__t.html">I2C_ErrorCounters_t</a> i2c_error_counters ={0}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>I²C error counters. </p>
<p>Holds cumulative counts of specific I²C/TWI error events detected by the driver during operation.</p>
<p>These counters can be used for diagnostics and long-term monitoring of bus reliability.</p>
<p>Typical fields inside <a class="el" href="struct_i2_c___error_counters__t.html" title="Counters for different I2C/TWI error types.">I2C_ErrorCounters_t</a> may include:</p><ul>
<li><b>arbitration_lost</b> — number of times bus arbitration was lost</li>
<li><b>nack_on_address</b> — number of NACKs received after sending SLA+W or SLA+R</li>
<li><b>nack_on_data</b> — number of NACKs received after sending a data byte</li>
<li><b>bus_error</b> — number of illegal START/STOP conditions detected</li>
</ul>
<p>The structure is updated inside the <span class="tt">TWI_vect</span> ISR whenever an error-related TWI status code is encountered. </p>

</div>
</div>
<a id="a41fd49c4a663a655243908d0f709bd1a" name="a41fd49c4a663a655243908d0f709bd1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41fd49c4a663a655243908d0f709bd1a">&#9670;&#160;</a></span>i2c_state</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile uint8_t i2c_state =<a class="el" href="i2c_8h.html#ae3f6a60c396d9f1a51eb4ecc981951fa">I2C_STATE_IDLE</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Current state of the I²C finite state machine (FSM). </p>
<p>Represents the current step of the I²C driver’s FSM during transmission. The FSM is updated in the <span class="tt">TWI_vect</span> interrupt handler in response to TWI status codes. </p>

</div>
</div>
<a id="aec1f537d4e465641ecde4ad6ec87b894" name="aec1f537d4e465641ecde4ad6ec87b894"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec1f537d4e465641ecde4ad6ec87b894">&#9670;&#160;</a></span>i2c_status</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile uint8_t i2c_status =0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Current status of the I2C state machine. </p>
<p>Status of the current I²C operation.</p>
<p>Stores the last TWI/I²C status code (from the TWSR register), indicating the current bus condition, e.g.:</p><ul>
<li>START condition transmitted</li>
<li>SLA+W / SLA+R transmitted and ACK/NACK received</li>
<li>Data byte transmitted/received with ACK/NACK</li>
<li>Bus errors (arbitration lost, ACK failure, etc.) </li>
</ul>

</div>
</div>
<a id="a5b113d44bda8ed39efc026d277878c09" name="a5b113d44bda8ed39efc026d277878c09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b113d44bda8ed39efc026d277878c09">&#9670;&#160;</a></span>i2c_tx_buffer_head</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile <a class="el" href="i2c_8h.html#a57b79314a222c848e2e86e83758e667e">i2c_tx_buf_index_t</a> i2c_tx_buffer_head =0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Index of the head position in the TX buffer. </p>

</div>
</div>
<a id="aab3b5c0fa4c5e46e6d6009f357dc891e" name="aab3b5c0fa4c5e46e6d6009f357dc891e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab3b5c0fa4c5e46e6d6009f357dc891e">&#9670;&#160;</a></span>i2c_tx_buffer_tail</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile <a class="el" href="i2c_8h.html#a57b79314a222c848e2e86e83758e667e">i2c_tx_buf_index_t</a> i2c_tx_buffer_tail =0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Index of the tail position in the TX buffer. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_5290e710249d6b673b2b660f4556b41f.html">avr_peripherals</a></li><li class="navelem"><a href="dir_31f044720ecb31fd870420d8de3bcd69.html">i2c</a></li><li class="navelem"><a href="i2c_8c.html">i2c.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
