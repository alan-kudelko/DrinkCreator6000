<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DrinkCreator6000: avr_peripherals/i2c/i2c_ringbuffer.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">DrinkCreator6000
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('i2c__ringbuffer_8h.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">i2c_ringbuffer.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Non-blocking I2C (TWI) Master driver for AVR (ATmega2560) using a TX ring buffer.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;<a class="el" href="i2c__common_8h_source.html">i2c_common.h</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for i2c_ringbuffer.h:</div>
<div class="dyncontent">
<div class="center"><img src="i2c__ringbuffer_8h__incl.png" border="0" usemap="#aavr__peripherals_2i2c_2i2c__ringbuffer_8h" loading="lazy" alt=""/></div>
<map name="aavr__peripherals_2i2c_2i2c__ringbuffer_8h" id="aavr__peripherals_2i2c_2i2c__ringbuffer_8h">
<area shape="rect" title="Non&#45;blocking I2C (TWI) Master driver for AVR (ATmega2560) using a TX ring buffer." alt="" coords="5,5,136,48"/>
<area shape="rect" title=" " alt="" coords="58,171,123,197"/>
<area shape="poly" title=" " alt="" coords="50,50,37,66,26,84,20,103,24,122,38,142,57,159,53,163,34,146,19,124,15,103,21,82,32,63,46,47"/>
<area shape="rect" title=" " alt="" coords="33,96,108,123"/>
<area shape="poly" title=" " alt="" coords="73,49,73,80,68,80,68,49"/>
<area shape="rect" href="i2c__common_8h.html" title="Common I2C (TWI) definitions and macros for AVR projects." alt="" coords="132,96,238,123"/>
<area shape="poly" title=" " alt="" coords="102,46,156,85,153,89,99,51"/>
<area shape="poly" title=" " alt="" coords="170,125,121,163,117,159,167,121"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="i2c__ringbuffer_8h__dep__incl.png" border="0" usemap="#aavr__peripherals_2i2c_2i2c__ringbuffer_8hdep" loading="lazy" alt=""/></div>
<map name="aavr__peripherals_2i2c_2i2c__ringbuffer_8hdep" id="aavr__peripherals_2i2c_2i2c__ringbuffer_8hdep">
<area shape="rect" title="Non&#45;blocking I2C (TWI) Master driver for AVR (ATmega2560) using a TX ring buffer." alt="" coords="390,5,521,48"/>
<area shape="rect" href="i2c_8h.html" title="I2C (TWI) Master driver for AVR (ATmega2560) with optional TX buffer." alt="" coords="313,96,443,139"/>
<area shape="poly" title=" " alt="" coords="430,62,398,97,394,94,426,58"/>
<area shape="rect" href="i2c__ringbuffer_8c.html" title=" " alt="" coords="468,96,598,139"/>
<area shape="poly" title=" " alt="" coords="485,58,517,94,513,97,481,62"/>
<area shape="rect" href="_h_d44780___i2_c_8cpp.html" title=" " alt="" coords="5,195,178,221"/>
<area shape="poly" title=" " alt="" coords="299,146,133,197,132,192,297,141"/>
<area shape="rect" href="_drink_creator6000_8cpp.html" title=" " alt="" coords="202,195,373,221"/>
<area shape="poly" title=" " alt="" coords="348,152,302,196,298,192,344,148"/>
<area shape="rect" href="_drink_creator6000___init_8cpp.html" title=" " alt="" coords="396,187,542,229"/>
<area shape="poly" title=" " alt="" coords="412,148,450,184,446,188,408,152"/>
<area shape="rect" href="task_update_screen_8cpp.html" title=" " alt="" coords="566,195,742,221"/>
<area shape="poly" title=" " alt="" coords="458,141,615,192,614,197,456,146"/>
</map>
</div>
</div>
<p><a href="i2c__ringbuffer_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:I2C_5FData_5Ft" id="r_I2C_5FData_5Ft"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_i2_c___data__t.html">I2C_Data_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure representing a single I2C data packet.  <a href="struct_i2_c___data__t.html#details">More...</a><br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-define-members" class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a013b5aa673f45bca79848684bb2b7f6e" id="r_a013b5aa673f45bca79848684bb2b7f6e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a013b5aa673f45bca79848684bb2b7f6e">READ_FLAG</a>&#160;&#160;&#160;1</td></tr>
<tr class="memitem:a06e9b431be0da4da79c54eb2b27de980" id="r_a06e9b431be0da4da79c54eb2b27de980"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a06e9b431be0da4da79c54eb2b27de980">WRITE_FLAG</a>&#160;&#160;&#160;0</td></tr>
<tr class="memitem:a177534082408c004b9e85877b9d026ad" id="r_a177534082408c004b9e85877b9d026ad"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a177534082408c004b9e85877b9d026ad">LAST_PACKAGE</a>&#160;&#160;&#160;1</td></tr>
<tr class="memitem:a5ee7f544aa492d779cd8e031534160cb" id="r_a5ee7f544aa492d779cd8e031534160cb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5ee7f544aa492d779cd8e031534160cb">NOT_LAST_PACKAGE</a>&#160;&#160;&#160;0</td></tr>
<tr class="memitem:ae9087d23a50a61f9d92ca1d6818e9139" id="r_ae9087d23a50a61f9d92ca1d6818e9139"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae9087d23a50a61f9d92ca1d6818e9139">DATA_PACKAGE</a>&#160;&#160;&#160;1</td></tr>
<tr class="memitem:aeecd740e1b25bfabae49e45628a75869" id="r_aeecd740e1b25bfabae49e45628a75869"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeecd740e1b25bfabae49e45628a75869">ADDRESS_PACKAGE</a>&#160;&#160;&#160;0</td></tr>
<tr class="memitem:ae825b0afbc4d9119b626fd77770295fe" id="r_ae825b0afbc4d9119b626fd77770295fe"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae825b0afbc4d9119b626fd77770295fe">RW_BIT</a>&#160;&#160;&#160;0</td></tr>
<tr class="memitem:a9f147b3a3d65d9ded66779bef8056ecb" id="r_a9f147b3a3d65d9ded66779bef8056ecb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9f147b3a3d65d9ded66779bef8056ecb">LP_BIT</a>&#160;&#160;&#160;1</td></tr>
<tr class="memitem:a6027dafcc1a393794288675aaa0449ec" id="r_a6027dafcc1a393794288675aaa0449ec"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6027dafcc1a393794288675aaa0449ec">DA_BIT</a>&#160;&#160;&#160;2</td></tr>
<tr class="memitem:a24007cd8c0a6a3aae0965b4032a92c2d" id="r_a24007cd8c0a6a3aae0965b4032a92c2d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a24007cd8c0a6a3aae0965b4032a92c2d">TIMER4_POLLING_CYCLE</a>&#160;&#160;&#160;255</td></tr>
<tr class="memdesc:a24007cd8c0a6a3aae0965b4032a92c2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">OCR4A value for Timer 4 in "polling" mode.  <br /></td></tr>
<tr class="memitem:ab7f7ead164f2e3dc08ce8a60ff6819ab" id="r_ab7f7ead164f2e3dc08ce8a60ff6819ab"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab7f7ead164f2e3dc08ce8a60ff6819ab">TIMER4_SENDING_CYCLE</a>&#160;&#160;&#160;14</td></tr>
<tr class="memdesc:ab7f7ead164f2e3dc08ce8a60ff6819ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">OCR4A value for Timer 4 in "sending" mode (fast ISR during active I2C transmission).  <br /></td></tr>
<tr id="define-members-0" class="groupHeader"><td colspan="2"><div class="groupHeader">I2C Finite State Machine (FSM) states</div></td></tr>
<tr class="memitem:ae3f6a60c396d9f1a51eb4ecc981951fa" id="r_ae3f6a60c396d9f1a51eb4ecc981951fa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae3f6a60c396d9f1a51eb4ecc981951fa">I2C_STATE_IDLE</a>&#160;&#160;&#160;0</td></tr>
<tr class="memitem:abaadc33325af0f9fab5d70b9dcefbb00" id="r_abaadc33325af0f9fab5d70b9dcefbb00"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abaadc33325af0f9fab5d70b9dcefbb00">I2C_STATE_START_SENT</a>&#160;&#160;&#160;1</td></tr>
<tr class="memitem:ac1aaf47d7389feab0be4edb7ea2ab2ae" id="r_ac1aaf47d7389feab0be4edb7ea2ab2ae"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac1aaf47d7389feab0be4edb7ea2ab2ae">I2C_STATE_ADDRESS_SENT</a>&#160;&#160;&#160;2</td></tr>
<tr class="memitem:a4a31ca4c828c1e98d0395950c2042a8d" id="r_a4a31ca4c828c1e98d0395950c2042a8d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4a31ca4c828c1e98d0395950c2042a8d">I2C_STATE_DATA_SENT</a>&#160;&#160;&#160;3</td></tr>
<tr class="memitem:a8b9cbea0b5173f4fc60576dad01f3006" id="r_a8b9cbea0b5173f4fc60576dad01f3006"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8b9cbea0b5173f4fc60576dad01f3006">I2C_STATE_ERROR</a>&#160;&#160;&#160;4</td></tr>
<tr class="memitem:ad07634d5ed5abd7f4e2473117000c03b" id="r_ad07634d5ed5abd7f4e2473117000c03b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad07634d5ed5abd7f4e2473117000c03b">I2C_STATE_DATA_RECEIVED</a>&#160;&#160;&#160;5</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5730d9445429351b9f750084c5cb5aae" id="r_a5730d9445429351b9f750084c5cb5aae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5730d9445429351b9f750084c5cb5aae">i2c_init</a> (void)</td></tr>
<tr class="memdesc:a5730d9445429351b9f750084c5cb5aae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize I²C (TWI) hardware and Timer4 support.  <br /></td></tr>
<tr class="memitem:a5a1923e2271df541e858cb4e05d7b895" id="r_a5a1923e2271df541e858cb4e05d7b895"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5a1923e2271df541e858cb4e05d7b895">i2c_enable</a> (void)</td></tr>
<tr class="memdesc:a5a1923e2271df541e858cb4e05d7b895"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable I²C hardware and Timer4.  <br /></td></tr>
<tr class="memitem:abe70f8fe4c72329b89ec526c749f50d7" id="r_abe70f8fe4c72329b89ec526c749f50d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abe70f8fe4c72329b89ec526c749f50d7">i2c_disable</a> (void)</td></tr>
<tr class="memdesc:abe70f8fe4c72329b89ec526c749f50d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable I²C hardware and Timer4 if used.  <br /></td></tr>
<tr class="memitem:a5d09f10466d174ce0b5c5bb3045eb52f" id="r_a5d09f10466d174ce0b5c5bb3045eb52f"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5d09f10466d174ce0b5c5bb3045eb52f">i2c_tx_buffer_is_empty</a> (void)</td></tr>
<tr class="memdesc:a5d09f10466d174ce0b5c5bb3045eb52f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the I2C TX buffer is empty.  <br /></td></tr>
<tr class="memitem:a34466b1132aef1e13135a1a7bcf65ac0" id="r_a34466b1132aef1e13135a1a7bcf65ac0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a34466b1132aef1e13135a1a7bcf65ac0">i2c_tx_buffer_clear_until_next_address</a> (void)</td></tr>
<tr class="memdesc:a34466b1132aef1e13135a1a7bcf65ac0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clears the TX buffer until the next address package is found.  <br /></td></tr>
<tr class="memitem:a91bb1859c12fbc7c029b2a5a2309b240" id="r_a91bb1859c12fbc7c029b2a5a2309b240"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a91bb1859c12fbc7c029b2a5a2309b240">i2c_write_byte_to_address_blocking</a> (uint8_t address, uint8_t data)</td></tr>
<tr class="memdesc:a91bb1859c12fbc7c029b2a5a2309b240"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a single data byte to the specified I2C slave address in blocking mode.  <br /></td></tr>
<tr class="memitem:ae74a6ec74823b5c3816959f3f696e945" id="r_ae74a6ec74823b5c3816959f3f696e945"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae74a6ec74823b5c3816959f3f696e945">i2c_write_bytes_to_address_blocking</a> (uint8_t address, uint8_t *data, uint8_t length)</td></tr>
<tr class="memdesc:ae74a6ec74823b5c3816959f3f696e945"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends multiple data bytes to the specified I2C slave address in blocking mode.  <br /></td></tr>
<tr class="memitem:a3340873d4d96bc2b3fd606ac298ed51c" id="r_a3340873d4d96bc2b3fd606ac298ed51c"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3340873d4d96bc2b3fd606ac298ed51c">i2c_write_byte_to_address_non_blocking</a> (uint8_t address, uint8_t data)</td></tr>
<tr class="memdesc:a3340873d4d96bc2b3fd606ac298ed51c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enqueues a single data byte to be sent to the specified I²C slave address in non-blocking mode.  <br /></td></tr>
<tr class="memitem:af1e6cced888d45c8d102d872acea1b76" id="r_af1e6cced888d45c8d102d872acea1b76"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af1e6cced888d45c8d102d872acea1b76">i2c_write_bytes_to_address_non_blocking</a> (uint8_t address, uint8_t *data, uint8_t length)</td></tr>
<tr class="memdesc:af1e6cced888d45c8d102d872acea1b76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enqueues multiple data bytes to be sent to the specified I²C slave address in non-blocking mode.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:abe1f812dc6284ef881acc78023cd7a9d" id="r_abe1f812dc6284ef881acc78023cd7a9d"><td class="memItemLeft" align="right" valign="top">volatile <a class="el" href="struct_i2_c___data__t.html">I2C_Data_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abe1f812dc6284ef881acc78023cd7a9d">i2c_buffer_tx</a> [<a class="el" href="#a547981ee4a0a60f7fa4826eb59ded9b7">I2C_TX_BUFFER_SIZE</a>]</td></tr>
<tr class="memdesc:abe1f812dc6284ef881acc78023cd7a9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transmit buffer holding I2C data packets to be sent.  <br /></td></tr>
<tr class="memitem:a5b113d44bda8ed39efc026d277878c09" id="r_a5b113d44bda8ed39efc026d277878c09"><td class="memItemLeft" align="right" valign="top">volatile <a class="el" href="#a57b79314a222c848e2e86e83758e667e">i2c_tx_buf_index_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5b113d44bda8ed39efc026d277878c09">i2c_tx_buffer_head</a></td></tr>
<tr class="memdesc:a5b113d44bda8ed39efc026d277878c09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index of the head position in the TX buffer.  <br /></td></tr>
<tr class="memitem:aab3b5c0fa4c5e46e6d6009f357dc891e" id="r_aab3b5c0fa4c5e46e6d6009f357dc891e"><td class="memItemLeft" align="right" valign="top">volatile <a class="el" href="#a57b79314a222c848e2e86e83758e667e">i2c_tx_buf_index_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aab3b5c0fa4c5e46e6d6009f357dc891e">i2c_tx_buffer_tail</a></td></tr>
<tr class="memdesc:aab3b5c0fa4c5e46e6d6009f357dc891e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index of the tail position in the TX buffer.  <br /></td></tr>
<tr class="memitem:a41fd49c4a663a655243908d0f709bd1a" id="r_a41fd49c4a663a655243908d0f709bd1a"><td class="memItemLeft" align="right" valign="top">volatile uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a41fd49c4a663a655243908d0f709bd1a">i2c_state</a></td></tr>
<tr class="memdesc:a41fd49c4a663a655243908d0f709bd1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current status of the I2C state machine.  <br /></td></tr>
<tr class="memitem:aec1f537d4e465641ecde4ad6ec87b894" id="r_aec1f537d4e465641ecde4ad6ec87b894"><td class="memItemLeft" align="right" valign="top">volatile uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aec1f537d4e465641ecde4ad6ec87b894">i2c_status</a></td></tr>
<tr class="memdesc:aec1f537d4e465641ecde4ad6ec87b894"><td class="mdescLeft">&#160;</td><td class="mdescRight">Status of the current I²C operation.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-member-group" class="groupheader"><a id="member-group" name="member-group"></a>
I2C TWI Master Transmitter status codes</h2></td></tr>
<tr class="memitem:a547981ee4a0a60f7fa4826eb59ded9b7" id="r_a547981ee4a0a60f7fa4826eb59ded9b7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a547981ee4a0a60f7fa4826eb59ded9b7">I2C_TX_BUFFER_SIZE</a>&#160;&#160;&#160;255</td></tr>
<tr class="memdesc:a547981ee4a0a60f7fa4826eb59ded9b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of the I2C transmit buffer, in bytes.  <br /></td></tr>
<tr class="memitem:af47492c802fe313ca8455294843378f6" id="r_af47492c802fe313ca8455294843378f6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af47492c802fe313ca8455294843378f6">I2C_RX_BUFFER_SIZE</a>&#160;&#160;&#160;64</td></tr>
<tr class="memdesc:af47492c802fe313ca8455294843378f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of the I2C receive buffer, in bytes.  <br /></td></tr>
<tr class="memitem:a57b79314a222c848e2e86e83758e667e" id="r_a57b79314a222c848e2e86e83758e667e"><td class="memItemLeft" align="right" valign="top">typedef uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a57b79314a222c848e2e86e83758e667e">i2c_tx_buf_index_t</a></td></tr>
<tr class="memdesc:a57b79314a222c848e2e86e83758e667e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index type for I2C TX buffer positions.  <br /></td></tr>
<tr class="memitem:a0a230fe8afcd367304de7418b913d2df" id="r_a0a230fe8afcd367304de7418b913d2df"><td class="memItemLeft" align="right" valign="top">typedef uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0a230fe8afcd367304de7418b913d2df">i2c_rx_buf_index_t</a></td></tr>
<tr class="memdesc:a0a230fe8afcd367304de7418b913d2df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index type for I2C RX buffer positions.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Non-blocking I2C (TWI) Master driver for AVR (ATmega2560) using a TX ring buffer. </p>
<p>This module implements non-blocking I2C communication in Master mode with a transmit ring buffer that stores data packets (address + data). It allows continuous sending of multiple packets without blocking the CPU. The driver is RTOS-independent and suitable for real-time applications.</p>
<dl class="section note"><dt>Note</dt><dd>TX buffer size can be configured via macros. </dd>
<dd>
Communication is handled via interrupts:<ul>
<li>Timer4 Compare A (<span class="tt">TIMER4_COMPA_vect</span>) starts I2C transmission when buffer is non-empty.</li>
<li>TWI interrupt (<span class="tt">TWI_vect</span>) continues sending data packets and handles STOP conditions. </li>
</ul>
</dd>
<dd>
Timing between consecutive data bytes is managed internally by the ISR. </dd>
<dd>
Timer4 is configured with prescaler 64 to generate ~10 µs ticks for I2C scheduling.</dd></dl>
<p>This implementation provides full low-level control over the bus while minimizing CPU blocking, suitable for high-frequency or multitasking scenarios. </p>
</div><a name="doc-define-members" id="doc-define-members"></a><h2 id="header-doc-define-members" class="groupheader">Macro Definition Documentation</h2>
<a id="aeecd740e1b25bfabae49e45628a75869" name="aeecd740e1b25bfabae49e45628a75869"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeecd740e1b25bfabae49e45628a75869">&#9670;&#160;</a></span>ADDRESS_PACKAGE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ADDRESS_PACKAGE&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flag indicating address package </p>

</div>
</div>
<a id="a6027dafcc1a393794288675aaa0449ec" name="a6027dafcc1a393794288675aaa0449ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6027dafcc1a393794288675aaa0449ec">&#9670;&#160;</a></span>DA_BIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DA_BIT&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae9087d23a50a61f9d92ca1d6818e9139" name="ae9087d23a50a61f9d92ca1d6818e9139"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9087d23a50a61f9d92ca1d6818e9139">&#9670;&#160;</a></span>DATA_PACKAGE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DATA_PACKAGE&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flag indicating data package </p>

</div>
</div>
<a id="af47492c802fe313ca8455294843378f6" name="af47492c802fe313ca8455294843378f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af47492c802fe313ca8455294843378f6">&#9670;&#160;</a></span>I2C_RX_BUFFER_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I2C_RX_BUFFER_SIZE&#160;&#160;&#160;64</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Size of the I2C receive buffer, in bytes. </p>

</div>
</div>
<a id="ac1aaf47d7389feab0be4edb7ea2ab2ae" name="ac1aaf47d7389feab0be4edb7ea2ab2ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1aaf47d7389feab0be4edb7ea2ab2ae">&#9670;&#160;</a></span>I2C_STATE_ADDRESS_SENT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I2C_STATE_ADDRESS_SENT&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Address sent, waiting for ACK/NACK </p>

</div>
</div>
<a id="ad07634d5ed5abd7f4e2473117000c03b" name="ad07634d5ed5abd7f4e2473117000c03b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad07634d5ed5abd7f4e2473117000c03b">&#9670;&#160;</a></span>I2C_STATE_DATA_RECEIVED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I2C_STATE_DATA_RECEIVED&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Data byte received from slave, waiting for next action </p>

</div>
</div>
<a id="a4a31ca4c828c1e98d0395950c2042a8d" name="a4a31ca4c828c1e98d0395950c2042a8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a31ca4c828c1e98d0395950c2042a8d">&#9670;&#160;</a></span>I2C_STATE_DATA_SENT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I2C_STATE_DATA_SENT&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Data byte sent, waiting for ACK/NACK </p>

</div>
</div>
<a id="a8b9cbea0b5173f4fc60576dad01f3006" name="a8b9cbea0b5173f4fc60576dad01f3006"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b9cbea0b5173f4fc60576dad01f3006">&#9670;&#160;</a></span>I2C_STATE_ERROR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I2C_STATE_ERROR&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Error occurred during transmission </p>

</div>
</div>
<a id="ae3f6a60c396d9f1a51eb4ecc981951fa" name="ae3f6a60c396d9f1a51eb4ecc981951fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3f6a60c396d9f1a51eb4ecc981951fa">&#9670;&#160;</a></span>I2C_STATE_IDLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I2C_STATE_IDLE&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Idle state, no ongoing transmission </p>

</div>
</div>
<a id="abaadc33325af0f9fab5d70b9dcefbb00" name="abaadc33325af0f9fab5d70b9dcefbb00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abaadc33325af0f9fab5d70b9dcefbb00">&#9670;&#160;</a></span>I2C_STATE_START_SENT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I2C_STATE_START_SENT&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>START condition sent, waiting for acknowledgment </p>

</div>
</div>
<a id="a547981ee4a0a60f7fa4826eb59ded9b7" name="a547981ee4a0a60f7fa4826eb59ded9b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a547981ee4a0a60f7fa4826eb59ded9b7">&#9670;&#160;</a></span>I2C_TX_BUFFER_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I2C_TX_BUFFER_SIZE&#160;&#160;&#160;255</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Size of the I2C transmit buffer, in bytes. </p>

</div>
</div>
<a id="a177534082408c004b9e85877b9d026ad" name="a177534082408c004b9e85877b9d026ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a177534082408c004b9e85877b9d026ad">&#9670;&#160;</a></span>LAST_PACKAGE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LAST_PACKAGE&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flag indicating last package </p>

</div>
</div>
<a id="a9f147b3a3d65d9ded66779bef8056ecb" name="a9f147b3a3d65d9ded66779bef8056ecb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f147b3a3d65d9ded66779bef8056ecb">&#9670;&#160;</a></span>LP_BIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LP_BIT&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5ee7f544aa492d779cd8e031534160cb" name="a5ee7f544aa492d779cd8e031534160cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ee7f544aa492d779cd8e031534160cb">&#9670;&#160;</a></span>NOT_LAST_PACKAGE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NOT_LAST_PACKAGE&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flag indicating not last package </p>

</div>
</div>
<a id="a013b5aa673f45bca79848684bb2b7f6e" name="a013b5aa673f45bca79848684bb2b7f6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a013b5aa673f45bca79848684bb2b7f6e">&#9670;&#160;</a></span>READ_FLAG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define READ_FLAG&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flag indicating read operation </p>

</div>
</div>
<a id="ae825b0afbc4d9119b626fd77770295fe" name="ae825b0afbc4d9119b626fd77770295fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae825b0afbc4d9119b626fd77770295fe">&#9670;&#160;</a></span>RW_BIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RW_BIT&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a24007cd8c0a6a3aae0965b4032a92c2d" name="a24007cd8c0a6a3aae0965b4032a92c2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24007cd8c0a6a3aae0965b4032a92c2d">&#9670;&#160;</a></span>TIMER4_POLLING_CYCLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TIMER4_POLLING_CYCLE&#160;&#160;&#160;255</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>OCR4A value for Timer 4 in "polling" mode. </p>
<p>Timer 4 generates an interrupt at a defined period, used to check whether there are data in the I2C buffer to be sent. The OCR4A value sets the time between consecutive ISR calls.</p>
<p>Calculation of OCR4A:   </p><p class="formulaDsp">
\[OCR4A = \frac{T_{interrupt}}{T_{tick}} - 1
\]
</p>
<p> where:</p><ul>
<li>\(T_{interrupt}\) is the desired interrupt period (in seconds),</li>
<li>\(T_{tick}\) is the timer tick period (here 4 µs = 4e-6 s).</li>
</ul>
<p>For OCR4A = 255 with 4 µs tick:   </p><p class="formulaDsp">
\[T_{interrupt} = (OCR4A + 1) * T_{tick} = (255 + 1) * 4\mu s \approx 1.024\ ms
\]
</p>
 
</div>
</div>
<a id="ab7f7ead164f2e3dc08ce8a60ff6819ab" name="ab7f7ead164f2e3dc08ce8a60ff6819ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7f7ead164f2e3dc08ce8a60ff6819ab">&#9670;&#160;</a></span>TIMER4_SENDING_CYCLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TIMER4_SENDING_CYCLE&#160;&#160;&#160;14</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>OCR4A value for Timer 4 in "sending" mode (fast ISR during active I2C transmission). </p>
<p>The timer interval is reduced to accelerate polling while sending data.</p>
<p>Calculation of OCR4A:   </p><p class="formulaDsp">
\[T_{interrupt} = (OCR4A + 1) * T_{tick}
\]
</p>
<p>For OCR4A = 4 with 4 µs tick:   </p><p class="formulaDsp">
\[T_{interrupt} = (14 + 1) * 4\mu s = 60\mu s
\]
</p>
 
</div>
</div>
<a id="a06e9b431be0da4da79c54eb2b27de980" name="a06e9b431be0da4da79c54eb2b27de980"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06e9b431be0da4da79c54eb2b27de980">&#9670;&#160;</a></span>WRITE_FLAG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WRITE_FLAG&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flag indicating write operation </p>

</div>
</div>
<a name="doc-typedef-members" id="doc-typedef-members"></a><h2 id="header-doc-typedef-members" class="groupheader">Typedef Documentation</h2>
<a id="a0a230fe8afcd367304de7418b913d2df" name="a0a230fe8afcd367304de7418b913d2df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a230fe8afcd367304de7418b913d2df">&#9670;&#160;</a></span>i2c_rx_buf_index_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef uint8_t <a class="el" href="#a0a230fe8afcd367304de7418b913d2df">i2c_rx_buf_index_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Index type for I2C RX buffer positions. </p>
<p>Uses uint8_t if RX buffer size is 255 bytes or less, otherwise uint16_t. </p>

</div>
</div>
<a id="a57b79314a222c848e2e86e83758e667e" name="a57b79314a222c848e2e86e83758e667e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57b79314a222c848e2e86e83758e667e">&#9670;&#160;</a></span>i2c_tx_buf_index_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef uint8_t <a class="el" href="#a57b79314a222c848e2e86e83758e667e">i2c_tx_buf_index_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Index type for I2C TX buffer positions. </p>
<p>Uses uint8_t if TX buffer size is 255 bytes or less, otherwise uint16_t. </p>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="abe70f8fe4c72329b89ec526c749f50d7" name="abe70f8fe4c72329b89ec526c749f50d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe70f8fe4c72329b89ec526c749f50d7">&#9670;&#160;</a></span>i2c_disable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void i2c_disable </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Disable I²C hardware and Timer4 if used. </p>

</div>
</div>
<a id="a5a1923e2271df541e858cb4e05d7b895" name="a5a1923e2271df541e858cb4e05d7b895"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a1923e2271df541e858cb4e05d7b895">&#9670;&#160;</a></span>i2c_enable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void i2c_enable </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enable I²C hardware and Timer4. </p>

</div>
</div>
<a id="a5730d9445429351b9f750084c5cb5aae" name="a5730d9445429351b9f750084c5cb5aae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5730d9445429351b9f750084c5cb5aae">&#9670;&#160;</a></span>i2c_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void i2c_init </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize I²C (TWI) hardware and Timer4 support. </p>
<p>Configures SDA/SCL pins, sets TWI speed, and sets up Timer4 for polling cycles after STOP condition (used in blocking ring buffer mode). </p>

</div>
</div>
<a id="a34466b1132aef1e13135a1a7bcf65ac0" name="a34466b1132aef1e13135a1a7bcf65ac0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34466b1132aef1e13135a1a7bcf65ac0">&#9670;&#160;</a></span>i2c_tx_buffer_clear_until_next_address()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void i2c_tx_buffer_clear_until_next_address </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clears the TX buffer until the next address package is found. </p>
<p>This function advances the TX buffer tail index, effectively removing data packets until it reaches the next address package or the buffer head. It is used to discard pending data if a slave failed to respond, allowing the next transmission to be properly enqueued. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="i2c__ringbuffer_8h_a34466b1132aef1e13135a1a7bcf65ac0_icgraph.png" border="0" usemap="#ai2c__ringbuffer_8h_a34466b1132aef1e13135a1a7bcf65ac0_icgraph" loading="lazy" alt=""/></div>
<map name="ai2c__ringbuffer_8h_a34466b1132aef1e13135a1a7bcf65ac0_icgraph" id="ai2c__ringbuffer_8h_a34466b1132aef1e13135a1a7bcf65ac0_icgraph">
<area shape="rect" title="Clears the TX buffer until the next address package is found." alt="" coords="98,5,235,48"/>
<area shape="rect" href="i2c__ringbuffer_8c.html#a474f42eedbdc093683fdb4b88be3c48f" title=" " alt="" coords="5,13,50,40"/>
<area shape="poly" title=" " alt="" coords="82,29,50,29,50,24,82,24"/>
</map>
</div>

</div>
</div>
<a id="a5d09f10466d174ce0b5c5bb3045eb52f" name="a5d09f10466d174ce0b5c5bb3045eb52f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d09f10466d174ce0b5c5bb3045eb52f">&#9670;&#160;</a></span>i2c_tx_buffer_is_empty()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool i2c_tx_buffer_is_empty </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if the I2C TX buffer is empty. </p>
<dl class="section return"><dt>Returns</dt><dd>true if the TX buffer is empty, false otherwise. </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="i2c__ringbuffer_8h_a5d09f10466d174ce0b5c5bb3045eb52f_icgraph.png" border="0" usemap="#ai2c__ringbuffer_8h_a5d09f10466d174ce0b5c5bb3045eb52f_icgraph" loading="lazy" alt=""/></div>
<map name="ai2c__ringbuffer_8h_a5d09f10466d174ce0b5c5bb3045eb52f_icgraph" id="ai2c__ringbuffer_8h_a5d09f10466d174ce0b5c5bb3045eb52f_icgraph">
<area shape="rect" title="Checks if the I2C TX buffer is empty." alt="" coords="575,31,730,57"/>
<area shape="rect" href="i2c__ringbuffer_8c.html#a8aa6a32130ab26be17555166513a23ba" title=" " alt="" coords="449,5,494,32"/>
<area shape="poly" title=" " alt="" coords="559,34,494,24,495,19,560,28"/>
<area shape="rect" href="_drink_creator6000_8cpp.html#af5863d80f02086cec6575d444cb3ba4d" title=" " alt="" coords="416,56,527,83"/>
<area shape="poly" title=" " alt="" coords="560,60,528,64,527,59,559,54"/>
<area shape="rect" href="task_update_screen_8cpp.html#a95b4196d7cc3c3c908c70ec40498fd76" title=" " alt="" coords="239,56,368,83"/>
<area shape="poly" title=" " alt="" coords="401,72,369,72,369,67,401,67"/>
<area shape="rect" href="_drink_creator6000_8cpp.html#a9eabc803df0648f317c9414e1f8f90d6" title=" " alt="" coords="110,31,184,57"/>
<area shape="poly" title=" " alt="" coords="223,59,184,53,185,47,224,54"/>
<area shape="rect" href="_drink_creator6000_8cpp.html#a8b474bc28804b1a6e1dba4f7951657a2" title=" " alt="" coords="103,81,191,108"/>
<area shape="poly" title=" " alt="" coords="224,85,192,90,191,85,223,80"/>
<area shape="rect" href="_drink_creator6000_8cpp.html#a840291bc02cba5474a4cb46a9b9566fe" title=" " alt="" coords="5,56,55,83"/>
<area shape="poly" title=" " alt="" coords="95,58,56,67,54,61,94,53"/>
<area shape="poly" title=" " alt="" coords="87,84,54,77,55,72,88,79"/>
</map>
</div>

</div>
</div>
<a id="a91bb1859c12fbc7c029b2a5a2309b240" name="a91bb1859c12fbc7c029b2a5a2309b240"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91bb1859c12fbc7c029b2a5a2309b240">&#9670;&#160;</a></span>i2c_write_byte_to_address_blocking()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void i2c_write_byte_to_address_blocking </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>address</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>data</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends a single data byte to the specified I2C slave address in blocking mode. </p>
<p>This function enqueues the address and data byte into the TX buffer and waits until there is enough space in the buffer before returning. Interrupts are temporarily disabled during buffer updates to ensure atomicity and data consistency.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">address</td><td>7-bit I2C slave address. </td></tr>
    <tr><td class="paramname">data</td><td>Single byte to be transmitted. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3340873d4d96bc2b3fd606ac298ed51c" name="a3340873d4d96bc2b3fd606ac298ed51c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3340873d4d96bc2b3fd606ac298ed51c">&#9670;&#160;</a></span>i2c_write_byte_to_address_non_blocking()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_write_byte_to_address_non_blocking </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>address</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>data</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enqueues a single data byte to be sent to the specified I²C slave address in non-blocking mode. </p>
<p>This function attempts to add the address and data byte to the TX buffer. If the buffer is full, the function returns immediately with a status code indicating failure. Intended for use with RTOS or cooperative multitasking to avoid blocking the CPU.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">address</td><td>7-bit I²C slave address. </td></tr>
    <tr><td class="paramname">data</td><td>Single byte to be transmitted. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint8_t Returns 0 if the data was successfully queued, 1 if the TX buffer is full. </dd></dl>

</div>
</div>
<a id="ae74a6ec74823b5c3816959f3f696e945" name="ae74a6ec74823b5c3816959f3f696e945"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae74a6ec74823b5c3816959f3f696e945">&#9670;&#160;</a></span>i2c_write_bytes_to_address_blocking()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void i2c_write_bytes_to_address_blocking </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>address</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>length</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends multiple data bytes to the specified I2C slave address in blocking mode. </p>
<p>This function enqueues the address and data bytes into the TX buffer and waits until there is enough space in the buffer before returning. Interrupts are temporarily disabled during buffer updates to ensure atomicity and data consistency.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">address</td><td>7-bit I2C slave address. </td></tr>
    <tr><td class="paramname">data</td><td>Pointer to the data array to be transmitted. </td></tr>
    <tr><td class="paramname">length</td><td>Number of bytes to send. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af1e6cced888d45c8d102d872acea1b76" name="af1e6cced888d45c8d102d872acea1b76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1e6cced888d45c8d102d872acea1b76">&#9670;&#160;</a></span>i2c_write_bytes_to_address_non_blocking()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_write_bytes_to_address_non_blocking </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>address</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>length</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enqueues multiple data bytes to be sent to the specified I²C slave address in non-blocking mode. </p>
<p>This function attempts to add the address and multiple data bytes to the TX buffer. If there is not enough free space in the buffer, it returns immediately with a failure status. Suitable for RTOS-based or cooperative multitasking environments to avoid blocking the CPU.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">address</td><td>7-bit I²C slave address. </td></tr>
    <tr><td class="paramname">data</td><td>Pointer to the array of bytes to be transmitted. </td></tr>
    <tr><td class="paramname">length</td><td>Number of bytes to enqueue. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint8_t Returns 0 if all bytes were successfully queued, 1 if the TX buffer did not have enough space. </dd></dl>

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Variable Documentation</h2>
<a id="abe1f812dc6284ef881acc78023cd7a9d" name="abe1f812dc6284ef881acc78023cd7a9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe1f812dc6284ef881acc78023cd7a9d">&#9670;&#160;</a></span>i2c_buffer_tx</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">volatile <a class="el" href="struct_i2_c___data__t.html">I2C_Data_t</a> i2c_buffer_tx[<a class="el" href="#a547981ee4a0a60f7fa4826eb59ded9b7">I2C_TX_BUFFER_SIZE</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Transmit buffer holding I2C data packets to be sent. </p>

</div>
</div>
<a id="a41fd49c4a663a655243908d0f709bd1a" name="a41fd49c4a663a655243908d0f709bd1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41fd49c4a663a655243908d0f709bd1a">&#9670;&#160;</a></span>i2c_state</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">volatile uint8_t i2c_state</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Current status of the I2C state machine. </p>
<p>Current state of the I²C finite state machine (FSM).</p>
<p>Represents the current step of the I²C driver’s FSM during transmission. The FSM is updated in the <span class="tt">TWI_vect</span> interrupt handler in response to TWI status codes. </p>

</div>
</div>
<a id="aec1f537d4e465641ecde4ad6ec87b894" name="aec1f537d4e465641ecde4ad6ec87b894"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec1f537d4e465641ecde4ad6ec87b894">&#9670;&#160;</a></span>i2c_status</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">volatile uint8_t i2c_status</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Status of the current I²C operation. </p>
<p>Stores the last TWI/I²C status code (from the TWSR register), indicating the current bus condition, e.g.:</p><ul>
<li>START condition transmitted</li>
<li>SLA+W / SLA+R transmitted and ACK/NACK received</li>
<li>Data byte transmitted/received with ACK/NACK</li>
<li>Bus errors (arbitration lost, ACK failure, etc.) </li>
</ul>

</div>
</div>
<a id="a5b113d44bda8ed39efc026d277878c09" name="a5b113d44bda8ed39efc026d277878c09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b113d44bda8ed39efc026d277878c09">&#9670;&#160;</a></span>i2c_tx_buffer_head</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">volatile <a class="el" href="#a57b79314a222c848e2e86e83758e667e">i2c_tx_buf_index_t</a> i2c_tx_buffer_head</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Index of the head position in the TX buffer. </p>

</div>
</div>
<a id="aab3b5c0fa4c5e46e6d6009f357dc891e" name="aab3b5c0fa4c5e46e6d6009f357dc891e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab3b5c0fa4c5e46e6d6009f357dc891e">&#9670;&#160;</a></span>i2c_tx_buffer_tail</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">volatile <a class="el" href="#a57b79314a222c848e2e86e83758e667e">i2c_tx_buf_index_t</a> i2c_tx_buffer_tail</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Index of the tail position in the TX buffer. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_5290e710249d6b673b2b660f4556b41f.html">avr_peripherals</a></li><li class="navelem"><a href="dir_31f044720ecb31fd870420d8de3bcd69.html">i2c</a></li><li class="navelem"><a href="i2c__ringbuffer_8h.html">i2c_ringbuffer.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
